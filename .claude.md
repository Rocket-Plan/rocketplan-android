# Rocketplan Android

An Android application built with Kotlin and modern Android development practices.

## Project Overview

**Package:** `com.example.rocketplan_android`
**Min SDK:** 24 (Android 7.0)
**Target SDK:** 36
**Compile SDK:** 36
**Version:** 1.0 (versionCode: 1)

This is a Navigation Drawer-based Android application template with multiple fragments and Material Design components.

## Environment Configuration

The app supports **three environments** managed through Android Product Flavors:
- **dev** - Development (`com.example.rocketplan_android.dev`) - https://api-qa-mongoose-br2wu78v1.rocketplantech.com
- **staging** - Test/Staging (`com.example.rocketplan_android.staging`) - https://api-staging-mongoose-n5tr2spgf.rocketplantech.com
- **prod** - Production (`com.example.rocketplan_android`) - https://api-public.rocketplantech.com

Each environment has its own API endpoints, app name, and configuration. See **[ENVIRONMENT_CONFIG.md](ENVIRONMENT_CONFIG.md)** for complete setup guide.

**Quick build commands:**
```bash
./gradlew assembleDevDebug      # Dev environment
./gradlew assembleStagingDebug     # Staging environment
./gradlew assembleProdRelease   # Production build
```

## Architecture

### Technology Stack

- **Language:** Kotlin
- **Build System:** Gradle (Kotlin DSL)
- **UI Framework:** Android Views with View Binding
- **Architecture Pattern:** MVVM (Model-View-ViewModel)
- **Navigation:** Jetpack Navigation Component
- **Design:** Material Design 3

### Key Dependencies

- **AndroidX Core KTX** - Kotlin extensions for Android
- **AndroidX AppCompat** - Backward-compatible support library
- **Material Components** - Material Design UI components
- **ConstraintLayout** - Flexible layout system
- **Lifecycle Components** - LiveData and ViewModel
- **Navigation Component** - Fragment navigation with type safety

### Build Configuration

- **Java Version:** 11
- **View Binding:** Enabled
- **ProGuard:** Configured for release builds (currently disabled)

## Project Structure

```
app/
├── src/
│   ├── main/
│   │   ├── java/com/example/rocketplan_android/
│   │   │   ├── MainActivity.kt          # Main activity with navigation drawer
│   │   │   └── ui/
│   │   │       ├── home/                # Home screen module
│   │   │       │   ├── HomeFragment.kt
│   │   │       │   └── HomeViewModel.kt
│   │   │       ├── gallery/             # Gallery screen module
│   │   │       │   ├── GalleryFragment.kt
│   │   │       │   └── GalleryViewModel.kt
│   │   │       └── slideshow/           # Slideshow screen module
│   │   │           ├── SlideshowFragment.kt
│   │   │           └── SlideshowViewModel.kt
│   │   ├── res/
│   │   │   ├── layout/                  # XML layouts
│   │   │   ├── navigation/              # Navigation graph
│   │   │   ├── menu/                    # Menu resources
│   │   │   ├── drawable/                # Vector drawables
│   │   │   └── values/                  # Strings, colors, themes
│   │   └── AndroidManifest.xml
│   ├── test/                            # Unit tests
│   └── androidTest/                     # Instrumentation tests
├── build.gradle.kts
└── proguard-rules.pro
```

## Main Components

### MainActivity (`MainActivity.kt:16`)

The main entry point of the application featuring:
- Navigation Drawer with three destinations
- App bar with toolbar
- Floating Action Button (FAB)
- Navigation setup with `AppBarConfiguration`

**Top-Level Destinations:**
- Home (`R.id.nav_home`)
- Gallery (`R.id.nav_gallery`)
- Slideshow (`R.id.nav_slideshow`)

### UI Modules

Each UI module follows the MVVM pattern:

1. **LoginFragment/LoginViewModel** - Login/Authentication screen (entry point)
2. **HomeFragment/HomeViewModel** - Home screen
3. **GalleryFragment/GalleryViewModel** - Gallery screen
4. **SlideshowFragment/SlideshowViewModel** - Slideshow screen

### Authentication

**Login Implementation** (`ui/login/`):
- Email/password authentication
- Form validation (email format, password length)
- Custom input field components matching iOS design
- Integration with environment-specific API endpoints
- See **[LOGIN_IMPLEMENTATION.md](LOGIN_IMPLEMENTATION.md)** for complete details

**Entry Point**: App launches to login screen, navigates to home after successful authentication

## Development Guidelines

### Code Style

- Use Kotlin for all new code
- Follow Android's Kotlin style guide
- Leverage Kotlin extensions (KTX libraries)
- Use View Binding for view access (no findViewById)

### Adding New Features

1. **New Fragment:**
   - Create Fragment and ViewModel in `ui/[feature-name]/`
   - Add navigation destination in `res/navigation/mobile_navigation.xml`
   - Update drawer menu in `res/menu/activity_main_drawer.xml`
   - Update `AppBarConfiguration` if it's a top-level destination

2. **New Dependencies:**
   - Use version catalogs (`libs.versions.toml`)
   - Add to `app/build.gradle.kts`

3. **Resources:**
   - Strings: `res/values/strings.xml`
   - Colors: `res/values/colors.xml`
   - Themes: `res/values/themes.xml`

### Testing

- **Unit Tests:** `src/test/` - JUnit tests for ViewModels and business logic
- **Instrumentation Tests:** `src/androidTest/` - UI tests with Espresso

## Building the Project

### Prerequisites

**Required:**
- Java 17 or newer (required for Android Gradle Plugin 8.13.0)
- Android SDK with API level 36
- Gradle 8.13 (included via wrapper)

**Install Java 17 (macOS):**
```bash
brew install openjdk@17
```

**Set JAVA_HOME for builds:**
```bash
export JAVA_HOME=/usr/local/opt/openjdk@17
```

Or add to your shell profile (`~/.zshrc` or `~/.bash_profile`):
```bash
echo 'export JAVA_HOME=/usr/local/opt/openjdk@17' >> ~/.zshrc
```

### Building

**Debug Build:**
```bash
export JAVA_HOME=/usr/local/opt/openjdk@17
./gradlew assembleDebug
```

Output: `app/build/outputs/apk/debug/app-debug.apk`

**Release Build:**
```bash
export JAVA_HOME=/usr/local/opt/openjdk@17
./gradlew assembleRelease
```

**Clean Build:**
```bash
export JAVA_HOME=/usr/local/opt/openjdk@17
./gradlew clean assembleDebug
```

### Testing

**Run Unit Tests:**
```bash
./gradlew test
```

**Run Instrumentation Tests:**
```bash
./gradlew connectedAndroidTest
```

Requires a connected Android device or running emulator.

### Installing

**Install Debug APK on Device:**
```bash
export JAVA_HOME=/usr/local/opt/openjdk@17
./gradlew installDebug
```

**Launch App:**
```bash
adb shell am start -n com.example.rocketplan_android/.MainActivity
```

### Development Workflow: Clean Logs & Reinstall

**Option 1: Reinstall (preserves app data - keeps login, database, cache):**

```bash
# Stop any running logcat, clear files, and clear device buffer
pkill -f "adb logcat" || true && rm -f ./debug/full.log && adb logcat -c

# Rebuild and install (use appropriate flavor)
./gradlew installDevDebug         # Dev environment
# OR
./gradlew installStagingDebug     # Staging environment
# OR
./gradlew installProdDebug        # Production environment

# Start capturing fresh logs in background
mkdir -p ./debug && adb logcat -v time > ./debug/full.log 2>&1 &
```

**Quick single command (dev environment, preserves data):**
```bash
pkill -f "adb logcat" || true && rm -f ./debug/full.log && adb logcat -c && ./gradlew installDevDebug && mkdir -p ./debug && adb logcat -v time > ./debug/full.log 2>&1 &
```

**Option 2: Complete fresh install (clears ALL app data - login, database, cache, preferences):**

```bash
# Uninstall the app completely
adb uninstall com.example.rocketplan_android.dev      # Dev
# OR
adb uninstall com.example.rocketplan_android.staging  # Staging
# OR
adb uninstall com.example.rocketplan_android          # Prod

# Clear logs
pkill -f "adb logcat" || true && rm -f ./debug/full.log && adb logcat -c

# Rebuild and install
./gradlew installDevDebug

# Start capturing fresh logs
mkdir -p ./debug && adb logcat -v time > ./debug/full.log 2>&1 &
```

**Quick single command (dev environment, complete fresh install):**
```bash
adb uninstall com.example.rocketplan_android.dev && pkill -f "adb logcat" || true && rm -f ./debug/full.log && adb logcat -c && ./gradlew installDevDebug && mkdir -p ./debug && adb logcat -v time > ./debug/full.log 2>&1 &
```

**What each option does:**

Option 1 (Reinstall):
- Old log processes are stopped
- Log files are cleared
- Device log buffer is cleared
- App is rebuilt with latest changes
- Fresh logs are captured automatically
- **App data is preserved** (useful for quick testing without re-logging in)

Option 2 (Fresh Install):
- All app data is completely removed
- Database is cleared
- Login session is cleared
- Cache and preferences are cleared
- **Best for testing from scratch** or debugging data-related issues

### Common Build Issues

**Issue:** `Dependency requires at least JVM runtime version 11`
**Solution:** Ensure Java 17 is installed and JAVA_HOME is set correctly

**Issue:** `Duplicate resources` error
**Solution:** Run `./gradlew clean` first

**Issue:** PDF/SVG files causing build errors
**Solution:** PDF/SVG assets are stored in `pdf_svg_assets_to_convert/` - convert them to PNG or XML vector drawables before adding to `drawable/`

## Configuration Files

- **`build.gradle.kts`** - Root project configuration
- **`settings.gradle.kts`** - Project structure and repositories
- **`app/build.gradle.kts`** - App module configuration
- **`gradle.properties`** - Gradle properties
- **`proguard-rules.pro`** - ProGuard/R8 rules for code shrinking

## Design System & Assets

### Brand Colors

The app uses RocketPlan's brand color palette migrated from iOS:

**Primary Colors** (`res/values/colors.xml`):
- `main_purple` (#9A00FF) - Primary brand color
- `secondary_purple` (#6D00E6) - Darker purple variant
- `light_purple` (#F4E5FF) - Light purple tint
- `button_gradient_top_purple` (#9601FF) - Gradient top
- `button_gradient_bottom_purple` (#6D00E6) - Gradient bottom

**Secondary Colors**:
- `background` (#F3F3F6) - Main background
- `secondary_background` (#F0F0F4) - Alternative background
- `card_border` (#D2CFDA) - Card borders
- `light_border` (#E8E7ED) - Light borders
- `icon_colour` (#5B476B) - Icon tint
- `light_text_rp` (#777185) - Secondary text
- `placeholder` (#B3ABC6) - Placeholder text

**Semantic Colors**:
- `dark_green` (#007760), `light_green` (#DCF5F0), `moss_green` (#4C7C18) - Success states
- `warning_red` (#E82828), `dark_red` (#C50000), `error_fill` (#FFF0F0) - Error states
- `secondary_brown` (#AB5E38), `secondary_yellow` (#E39600) - Accents
- `team_member_tag` (#DFF1FE), `team_member_tag_dark` (#4AB2FE) - Tags
- `foreman_tag` (#FCF5EC) - Special tags

### Theme Configuration

**Light Theme** (`res/values/themes.xml:3`):
- Uses `main_purple` as primary color
- Light backgrounds with `background` color
- Status bar uses `secondary_purple`

**Dark Theme** (`res/values-night/themes.xml:3`):
- Same purple branding
- Dark backgrounds (#1E1E1E, black)
- Adjusted text colors for readability

### Visual Assets (601 files migrated from iOS)

**App Icons** (`res/mipmap-*/`):
- Production app icon across all densities (mdpi to xxxhdpi)
- Round icon variants for adaptive icons
- Based on RocketPlan logo with rocket/purple branding

**Icons** (`res/drawable-*/`):

*Functional Icons* (135 files):
- Camera controls: `icon_camera`, `icon_flash`, `icon_switch_camera`, `icon_gallery`
- Project management: `icon_create_project`, `icon_delete_project`, `icon_project_complete`
- Actions: `icon_add_note`, `icon_edit`, `icon_trash`, `icon_share`, `icon_copy`
- UI controls: `icon_checked`, `icon_unchecked`, `icon_plus`, `icon_search`
- Visibility: `icon_eye_show`, `icon_eye_hide`

*Navigation Icons* (15 files):
- `icon_chevron_left`, `icon_chevron_right`, `icon_chevron_up`
- `icon_arrow_right`, `icon_arrow_up`
- `icon_xmark`, `icon_xmark_white`

*Object Icons* (56 files):
- People: `icon_person`, `icon_people`, `icon_circle_person`
- Communication: `icon_phone`, `icon_envelope`, `icon_sms_bubble`
- General: `icon_calendar`, `icon_watch`, `icon_pencil`, `icon_trash`

*Tab Bar Icons* (30 files):
- Projects: `icon_tab_projects`, `icon_tab_projects_fill`
- Map: `icon_tab_map`, `icon_tab_map_fill`
- People: `icon_tab_people`, `icon_tab_people_fill`
- Messages: `icon_tab_messages`, `icon_tab_messages_fill`
- Notifications: `icon_tab_notifications`, `icon_tab_notifications_fill`

*Country Flags* (15 files):
- `country_us`, `country_ca`, `country_gb`, `country_au`, `country_nz`
- Available in @1x, @2x, @3x densities

**Illustrations** (`res/drawable-*/`):

*Damage Categories* (32 files):
- `appliances`, `carpentry`, `ceiling`, `cleaning`, `electrical_fixtures`
- `exterior`, `floors`, `walls`, `plumbing_fixtures`, `roofing`, `structural`

*Damage Types* (29 files):
- `water`, `fire`, `smoke`, `wind`, `mold`, `asbestos`, `impact`
- Natural disasters, vandalism, biohazard

*Equipment Types* (10 files):
- `air_mover`, `air_scrubber`, `dehumidifier`, `drying_mat`
- Regular and white variants

*Room Types* (169 files):
- Residential: Living rooms, bedrooms, bathrooms, kitchens, garages
- Commercial: Offices, lobbies, conference rooms, warehouses
- 56+ unique room types with regular and white variants

*Property Illustrations* (45 files):
- `blueprint`, `contact`, `crew`, `documents`, `insurance`, `single_unit`, `multi_unit`

**Logos** (`res/drawable-*/`):
- `logo_horizontal`, `logo_vertical`, `logo_circle`
- `logo_black`, `logo_white`, `logo_rocket_launching`
- Social: `logo_facebook`, `logo_google`

### Asset Usage Examples

```kotlin
// In Kotlin code
binding.iconView.setImageResource(R.drawable.icon_camera)
binding.logoView.setImageResource(R.drawable.logo_horizontal)

// In XML layouts
<ImageView
    android:src="@drawable/icon_tab_projects"
    android:tint="?attr/colorPrimary" />

// Using colors
<Button
    android:background="@color/main_purple"
    android:textColor="@color/white" />

// Tab bar setup
bottomNav.menu.findItem(R.id.projects)
    .setIcon(R.drawable.icon_tab_projects)
```

### Asset Documentation

See these files for detailed asset information:
- `ASSET_MIGRATION_SUMMARY.md` - Complete migration details
- `QUICK_ASSET_REFERENCE.md` - Fast asset lookup guide
- `MIGRATION_SAMPLES.md` - Sample files per category

### Notes on Assets

**Ready to Use** (497 PNG files):
- All multi-density PNG assets are ready for immediate use
- Android automatically selects appropriate density

**Requires Conversion** (104 vector files):
- 99 PDF files should be converted to XML vector drawables
- 5 SVG files should be converted to XML vector drawables
- Use Android Studio: New → Vector Asset → Local file
- Or use online tools: svg2android.com

## Resource Configurations

The app supports:
- **Night Mode** - Dark theme variants (`values-night/`)
- **Landscape** - Tablet landscape dimensions (`values-land/`)
- **Tablet Layouts** - Different dimensions for w600dp and w1240dp screens
- **Multi-Density Assets** - Assets in mdpi, xhdpi, xxhdpi densities

## Next Steps

- Replace template fragments with actual feature implementations
- Update app name to "RocketPlan" in `strings.xml`
- ✅ App icons configured from iOS assets
- Implement actual functionality for FAB action
- Add proper navigation header content with RocketPlan branding
- Set up data layer (repositories, data sources)
- Configure dependency injection (Hilt/Koin)
- Add networking (Retrofit/OkHttp)
- Implement proper error handling
- Add analytics and crash reporting
- Convert PDF/SVG assets to XML vector drawables
- Implement bottom navigation using tab bar icons
- Create themed buttons using gradient colors

## Common Tasks

### Change App Name
Edit `app/src/main/res/values/strings.xml:2`

### Update Package Name
1. Refactor package in Android Studio
2. Update `namespace` in `app/build.gradle.kts:7`
3. Update `applicationId` in `app/build.gradle.kts:11`

### Add a New Screen
1. Create Fragment class extending `Fragment`
2. Create ViewModel class extending `ViewModel`
3. Create layout XML in `res/layout/`
4. Add navigation action in `res/navigation/mobile_navigation.xml`

## Notes

- View Binding is enabled - use generated binding classes
- The project uses Kotlin DSL for Gradle scripts
- Navigation component handles fragment transactions
- Material Design 3 components are available
